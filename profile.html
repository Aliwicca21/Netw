<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile</title>
  <link rel="stylesheet" href="eg.css"> 
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";  
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";  
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";  
    
    const firebaseConfig = {
      apiKey: "AIzaSyBGFMZtSytIPzF4XYLyA34DpF5q_k-UPL8",
      authDomain: "fir-dba4c.firebaseapp.com",
      projectId: "fir-dba4c",
      storageBucket: "fir-dba4c.firebasestorage.app",
      messagingSenderId: "160255207915",
      appId: "1:160255207915:web:ce8e69d43f62daf476d1ae",
      measurementId: "G-GYPNMR85G2"
    };
    
    const app = initializeApp(firebaseConfig);  
    const auth = getAuth(app);  
    const db = getFirestore(app);  
    let currentUser = null;  

    // ÿ™ÿ±ÿ¨ŸÖÿ© ÿßŸÑŸÜÿµŸàÿµ
    const translations = {
      en: {
        profileTitle: "Profile",
        username: "Username",
        fullname: "Full Name",
        email: "Email",
        phone: "Phone",
        birthdate: "Birth Date",
        balance: "Balance",
        subscription: "Subscription",
        endDate: "End Date",
        botStatus: "Bot Status",
        recharge: "üí≥ Recharge",
        renewMonth: "Renew 1 Month ($2.50)",
        renew3Months: "Renew 3 Months ($7.50)",
        renewYear: "Renew 1 Year ($30)",
        cancelSub: "Cancel Subscription",
        viewBot: "View Bot Data",
        editProfile: "Edit Profile",
        goBack: "Back",
        logout: "Logout"
      },
      ar: {
        profileTitle: "ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
        username: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
        fullname: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ",
        email: "ÿßŸÑÿ•ŸäŸÖŸäŸÑ",
        phone: "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
        birthdate: "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸÖŸäŸÑÿßÿØ",
        balance: "ÿßŸÑÿ±ÿµŸäÿØ",
        subscription: "ÿßŸÑÿßÿ¥ÿ™ÿ±ÿßŸÉ",
        endDate: "ŸÖŸàÿπÿØ ÿßŸÜÿ™Ÿáÿßÿ° ÿßŸÑÿßÿ¥ÿ™ÿ±ÿßŸÉ",
        botStatus: "ÿ≠ÿßŸÑÿ© ÿßŸÑÿ®Ÿàÿ™",
        recharge: "üí≥ ÿ¥ÿ≠ŸÜ ÿßŸÑÿ±ÿµŸäÿØ",
        renewMonth: "ÿ™ÿ¨ÿØŸäÿØ ÿ¥Ÿáÿ± (2.50$)",
        renew3Months: "ÿ™ÿ¨ÿØŸäÿØ 3 ÿ£ÿ¥Ÿáÿ± (7.50$)",
        renewYear: "ÿ™ÿ¨ÿØŸäÿØ ÿ≥ŸÜÿ© (30$)",
        cancelSub: "ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿßÿ¥ÿ™ÿ±ÿßŸÉ",
        viewBot: "ÿπÿ±ÿ∂ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ®Ÿàÿ™",
        editProfile: "ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
        goBack: "ÿ±ÿ¨Ÿàÿπ",
        logout: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨"
      }
    };

    // ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÑÿ∫ÿ©
    window.changeLanguage = function(lang) {
      document.getElementById("profileTitle").textContent = translations[lang].profileTitle;
      document.getElementById("label-username").textContent = translations[lang].username + ":";
      document.getElementById("label-fullname").textContent = translations[lang].fullname + ":";
      document.getElementById("label-email").textContent = translations[lang].email + ":";
      document.getElementById("label-phone").textContent = translations[lang].phone + ":";
      document.getElementById("label-birthdate").textContent = translations[lang].birthdate + ":";
      document.getElementById("label-balance").textContent = translations[lang].balance + ":";
      document.getElementById("label-subscription").textContent = translations[lang].subscription + ":";
      document.getElementById("label-end-date").textContent = translations[lang].endDate + ":";
      document.getElementById("label-bot-status").textContent = translations[lang].botStatus + ":";

      const buttons = document.querySelectorAll(".card button");
      buttons[0].textContent = translations[lang].recharge;
      buttons[1].textContent = translations[lang].renewMonth;
      buttons[2].textContent = translations[lang].renew3Months;
      buttons[3].textContent = translations[lang].renewYear;
      buttons[4].textContent = translations[lang].cancelSub;
      buttons[5].textContent = translations[lang].viewBot;
      buttons[6].textContent = translations[lang].editProfile;
      buttons[7].textContent = translations[lang].goBack;
      buttons[8].textContent = translations[lang].logout;
    }

    // ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÜ Firebase
    onAuthStateChanged(auth, async (user) => {  
      if (user) {  
        currentUser = user;  
        await loadUserData();  
        changeLanguage('en'); // ŸÑÿ∫ÿ© ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©: ÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿä
      } else {  
        window.location.href = "index.html";  
      }  
    });  

    async function loadUserData() {  
      if (!currentUser) return;  
      const docRef = doc(db, "users", currentUser.uid);  
      const docSnap = await getDoc(docRef);  
      if (docSnap.exists()) {  
        const data = docSnap.data();  
        document.getElementById("username").textContent = data.username || "No Name";  
        document.getElementById("fullname").textContent = data.fullname || "No Name";  
        document.getElementById("email").textContent = data.email;  
        document.getElementById("phone").textContent = data.phone || "N/A";  
        document.getElementById("birthdate").textContent = data.birthdate || "N/A";  
        document.getElementById("balance").textContent = (data.balance || 0).toFixed(2) + " $";  
        document.getElementById("subscription").textContent = data.subscription || "No Subscription";  
        document.getElementById("end-date").textContent = data.endDate || "N/A";  
        document.getElementById("bot-status").textContent = data.botActive ? "‚úÖ Active" : "‚ùå Inactive";  

        document.getElementById("profile-pic").src = data.photoURL || "https://via.placeholder.com/120";  
      }  
    }  

    window.logout = async function() {  
      await signOut(auth);  
      window.location.href = "index.html";  
    }  

    window.goToBot = function() {
      window.location.href = "botData.html";
    }

    window.goToEditProfile = function() {
      window.location.href = "edit-profile.html";
    }

    window.goBack = function() {
      window.history.back();
    }

    window.renewSub = function(months) {
      window.location.href = "recharge.html?months=" + months;
    }

    window.cancelSub = function() {
      window.location.href = "recharge.html?cancel=true";
    }

    window.recharge = function() {
      window.location.href = "recharge.html";
    }
  </script>
</head>
<body>
  <div class="card">
    <!-- ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿ∫ÿ© -->
    <div class="language-selector">
      <label for="lang">Language:</label>
      <select id="lang" onchange="changeLanguage(this.value)">
        <option value="en" selected>English</option>
        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
      </select>
    </div>

    <img id="profile-pic" class="profile-pic" src="https://via.placeholder.com/120" alt="Profile Picture">
    <h2 id="profileTitle">Profile</h2>

    <p><strong id="label-username">Username:</strong> <span id="username">Loading...</span></p>
    <p><strong id="label-fullname">Full Name:</strong> <span id="fullname">Loading...</span></p>
    <p><strong id="label-email">Email:</strong> <span id="email">Loading...</span></p>
    <p><strong id="label-phone">Phone:</strong> <span id="phone">Loading...</span></p>
    <p><strong id="label-birthdate">Birth Date:</strong> <span id="birthdate">Loading...</span></p>
    <p><strong id="label-balance">Balance:</strong> <span id="balance">Loading...</span></p>
    <p><strong id="label-subscription">Subscription:</strong> <span id="subscription">Loading...</span></p>
    <p><strong id="label-end-date">End Date:</strong> <span id="end-date">Loading...</span></p>
    <p><strong id="label-bot-status">Bot Status:</strong> <span id="bot-status">Loading...</span></p>

    <div class="section">
      <h3>Recharge</h3>
      <button class="btn-success" onclick="recharge()">üí≥ Recharge</button>
    </div>

    <div class="section">
      <h3>Subscription</h3>
      <button class="btn-primary" onclick="renewSub(1)">Renew 1 Month ($2.50)</button>
      <button class="btn-primary" onclick="renewSub(3)">Renew 3 Months ($7.50)</button>
      <button class="btn-primary" onclick="renewSub(12)">Renew 1 Year ($30)</button>
      <button class="btn-danger" onclick="cancelSub()">Cancel Subscription</button>
    </div>

    <div class="section">
      <h3>Account</h3>
      <button class="btn-primary" onclick="goToBot()">View Bot Data</button>
      <button class="btn-primary" onclick="goToEditProfile()">Edit Profile</button>
      <button class="btn-secondary" onclick="goBack()">Back</button>
      <button class="btn-danger" onclick="logout()">Logout</button>
    </div>
  </div>
